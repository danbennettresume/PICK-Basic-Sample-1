DANB.SSN.ISSUE.LOCATE.01
$UDI I_COMMON
* DANB YYYYMMDD     Q&D TO FIND SSN ISSUE
*
OPEN '', 'CLIENT' TO CLIENT ELSE STOP " CLIENT"
OPEN "SAVEDLISTS" TO SAVEDLISTS ELSE STOP " SAVEDLISTS"
REC.CT = 0
SSN.MATCH = 0
DONE = 0
*
LOOP
  READNEXT MEMNUM ELSE DONE = 1
UNTIL DONE DO
  SSN.MATCH = ""
  READ CIO FROM CLIENT, MEMNUM ELSE CIO = ""
  SSN.ALL = CIO<23>
  SSN.TOT = DCOUNT(SSN.ALL, VM)
  FOR I = 1 TO SSN.TOT
    IF SSN.TOT<1, I> MATCHES "3N'-'2N'-'4N" THEN SSN.MATCH = MEMNUM
  NEXT I
  IF SSN.MATCH <> "" THEN
    MATCH.CT += 1
    SSN.LIST<-1> = MEMNUM
  END
  REC.CT += 1
  IF MOD(REC.CT, 1000) ELSE PRINT "PROCESSING " : REC.CT "R#5" : " " : MEMNUM
REPEAT
PRINT "PROCESSED  " : REC.CT "R#5
PRINT "SSN FOUND  " : MATCH.CT "R#5"
WRITE SSN.LIST TO SAVEDLISTS, "SSN.LIST000"
PRINT
PRINT "RETRIEVE LIST OF MEMBERS WITH USER ENTERED SSN WITH "
PRINT "GET.LIST SSN.LIST"
STOP
